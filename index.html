<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TacTivities - Get Out & Explore Tacoma</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #2d4a3e 0%, #1a2f24 100%);
            color: #f4f1eb;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .app-header {
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .app-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #a8c4a2;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 5px;
        }

        .app-subtitle {
            font-size: 0.9rem;
            color: #8fa395;
            font-weight: 300;
        }

        .main-container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #7ba885, #6a9773);
            color: white;
            box-shadow: 0 4px 15px rgba(123, 168, 133, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(123, 168, 133, 0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #f4f1eb;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.8rem;
        }

        .activity-card {
            background: linear-gradient(145deg, #4a6b5c, #3a5b4c);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 1px solid rgba(168, 196, 162, 0.2);
            min-height: 320px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #a8c4a2, #7ba885);
        }

        .activity-header {
            margin-bottom: 15px;
        }

        .activity-name {
            font-size: 1.4rem;
            font-weight: 600;
            color: #f4f1eb;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .activity-category {
            display: inline-block;
            background: rgba(168, 196, 162, 0.2);
            color: #a8c4a2;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .activity-description {
            font-size: 1rem;
            line-height: 1.5;
            color: #d4d1c9;
            margin: 15px 0;
        }

        .activity-meta {
            display: flex;
            gap: 8px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .meta-tag {
            background: rgba(0,0,0,0.3);
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.7rem;
            color: #b8c5be;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .activity-location {
            font-size: 0.9rem;
            color: #9aab9f;
            margin-top: 10px;
            font-style: italic;
        }

        .completed-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #7ba885;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .filters-container {
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            display: none;
        }

        .filters-container.show {
            display: block;
        }

        .filter-group {
            margin-bottom: 12px;
        }

        .filter-label {
            font-size: 0.8rem;
            color: #b8c5be;
            margin-bottom: 5px;
            display: block;
        }

        .filter-select {
            width: 100%;
            padding: 8px 12px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: #f4f1eb;
            font-size: 0.8rem;
        }

        .filter-select option {
            background: #2d4a3e;
            color: #f4f1eb;
        }

        .no-activities {
            text-align: center;
            padding: 40px 20px;
            color: #8fa395;
        }

        .management-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #7ba885;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .management-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
        }

        .modal-content {
            background: linear-gradient(145deg, #4a6b5c, #3a5b4c);
            margin: 10% auto;
            padding: 20px;
            border-radius: 15px;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #f4f1eb;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            color: #a8c4a2;
            font-size: 0.9rem;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: #f4f1eb;
            font-size: 0.9rem;
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-select option {
            background: #2d4a3e;
            color: #f4f1eb;
        }

        .activity-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .activity-item {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .activity-item-name {
            font-weight: 600;
            color: #f4f1eb;
            margin-bottom: 5px;
        }

        .activity-item-meta {
            font-size: 0.8rem;
            color: #b8c5be;
            margin-bottom: 10px;
        }

        .activity-item-actions {
            display: flex;
            gap: 10px;
        }

        .btn-danger {
            background: #d67070;
            color: white;
            border: none;
        }

        .error-message {
            background: rgba(214, 112, 112, 0.2);
            color: #d67070;
            padding: 10px;
            border-radius: 8px;
            margin-top: 20px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            border: 1px solid rgba(214, 112, 112, 0.3);
            display: none;
        }

        .success-message {
            background: rgba(123, 168, 133, 0.2);
            color: #7ba885;
            padding: 10px;
            border-radius: 8px;
            margin-top: 20px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            border: 1px solid rgba(123, 168, 133, 0.3);
            display: none;
        }

        .delete-confirm {
            background: rgba(214, 112, 112, 0.1);
            border: 1px solid #d67070;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .delete-confirm-text {
            color: #d67070;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .delete-confirm-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-confirm-delete {
            background: #d67070;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
        }

        .btn-cancel-delete {
            background: rgba(255,255,255,0.1);
            color: #f4f1eb;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #f4f1eb;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: #7ba885;
        }

        .btn-edit {
            background: #7ba885;
            color: white;
            border: none;
        }

        @media (max-width: 480px) {
            .main-container {
                padding: 15px;
            }
            
            .activity-card {
                margin: 10px 0;
                padding: 20px;
            }
            
            .app-title {
                font-size: 1.8rem;
            }
            
            .modal-content {
                margin: 5% auto;
                max-width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="app-header">
        <h1 class="app-title">TacTivities</h1>
        <p class="app-subtitle">Get Out & Explore Tacoma</p>
    </div>

    <div class="main-container">
        <div class="controls">
            <button class="btn btn-secondary btn-small" id="filterBtn">üîç Filters</button>
        </div>

        <div class="filters-container" id="filtersContainer">
            <div class="filter-group">
                <label class="filter-label">Time Commitment</label>
                <select class="filter-select" id="timeFilter">
                    <option value="">All</option>
                    <option value="quick">Quick (< 1 Hour)</option>
                    <option value="short">Short (1-2 Hours)</option>
                    <option value="medium">Medium (2-4 Hours)</option>
                    <option value="long">Long (4+ Hours)</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">Social Level</label>
                <select class="filter-select" id="socialnessFilter">
                    <option value="">All</option>
                    <option value="solo">Solo</option>
                    <option value="small_group">Small Group</option>
                    <option value="large_gathering">Large Gathering</option>
                    <option value="not_applicable">Not Applicable</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">Dog Friendly</label>
                <select class="filter-select" id="dogFriendlyFilter">
                    <option value="">All</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                    <option value="unknown">Unknown</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">Price</label>
                <select class="filter-select" id="priceFilter">
                    <option value="">All</option>
                    <option value="free">Free</option>
                    <option value="low">< $20</option>
                    <option value="medium">$21-$50</option>
                    <option value="high">$50+</option>
                    <option value="unknown">Unknown</option>
                </select>
            </div>
        </div>

        <div id="activityContainer"></div>
    </div>

    <button class="management-btn" id="managementBtn">‚öôÔ∏è</button>

    <div class="modal" id="managementModal">
        <div class="modal-content">
            <button class="modal-close" id="closeManagementModal">&times;</button>
            <h2 style="color: #a8c4a2; margin-bottom: 20px;">Manage Activities</h2>
            <button class="btn btn-primary" id="addActivityBtn" style="width: 100%; margin-bottom: 20px;">Add New Activity</button>
            <button class="btn btn-secondary" id="resetDefaultsBtn" style="width: 100%; margin-bottom: 20px;">Reset to Defaults</button>
            <h3 style="color: #f4f1eb; margin-bottom: 15px;">All Activities</h3>
            <div class="activity-list" id="activityList"></div>
        </div>
    </div>

    <div class="modal" id="activityModal">
        <div class="modal-content">
            <button class="modal-close" id="closeActivityModal">&times;</button>
            <h2 id="activityModalTitle" style="color: #a8c4a2; margin-bottom: 20px;">Add New Activity</h2>
            
            <form id="activityForm">
                <div class="form-group">
                    <label class="form-label">Activity Name</label>
                    <input type="text" class="form-input" id="activityName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-textarea" id="activityDescription" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Category (Select All That Apply)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item"><input type="checkbox" name="category" value="Outdoors"> Outdoors</label>
                        <label class="checkbox-item"><input type="checkbox" name="category" value="Culture"> Culture</label>
                        <label class="checkbox-item"><input type="checkbox" name="category" value="Food & Drink"> Food & Drink</label>
                        <label class="checkbox-item"><input type="checkbox" name="category" value="Social"> Social</label>
                        <label class="checkbox-item"><input type="checkbox" name="category" value="Fitness"> Fitness</label>
                        <label class="checkbox-item"><input type="checkbox" name="category" value="Creative"> Creative</label>
                        <label class="checkbox-item"><input type="checkbox" name="category" value="Shopping"> Shopping</label>
                        <label class="checkbox-item"><input type="checkbox" name="category" value="Entertainment"> Entertainment</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Time Commitment</label>
                    <select class="form-select" id="activityTime" required>
                        <option value="">Select Time</option>
                        <option value="quick">Quick (< 1 Hour)</option>
                        <option value="short">Short (1-2 Hours)</option>
                        <option value="medium">Medium (2-4 Hours)</option>
                        <option value="long">Long (4+ Hours)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Social Level (Select All That Apply)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item"><input type="checkbox" name="socialness" value="solo"> Solo</label>
                        <label class="checkbox-item"><input type="checkbox" name="socialness" value="small_group"> Small Group</label>
                        <label class="checkbox-item"><input type="checkbox" name="socialness" value="large_gathering"> Large Gathering</label>
                        <label class="checkbox-item"><input type="checkbox" name="socialness" value="not_applicable"> Not Applicable</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Dog Friendly</label>
                    <select class="form-select" id="activityDogFriendly">
                        <option value="">Select Dog Friendly</option>
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                        <option value="unknown">Unknown</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Price</label>
                    <select class="form-select" id="activityPrice">
                        <option value="">Select Price Range</option>
                        <option value="free">$0 (Free)</option>
                        <option value="low">< $20</option>
                        <option value="medium">$21-$50</option>
                        <option value="high">$50+</option>
                        <option value="unknown">Unknown</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Location</label>
                    <input type="text" class="form-input" id="activityLocation">
                </div>

                <div class="form-group">
                    <label class="form-label">Season (Optional)</label>
                    <select class="form-select" id="activitySeason">
                        <option value="">Year-Round</option>
                        <option value="spring">Spring</option>
                        <option value="summer">Summer</option>
                        <option value="fall">Fall</option>
                        <option value="winter">Winter</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Notes</label>
                    <textarea class="form-textarea" id="activityNotes"></textarea>
                </div>
                <button type="button" class="btn btn-primary" id="saveActivityBtn" style="width: 100%;">Save Activity</button>
                
                <div class="error-message" id="errorMessage"></div>
                <div class="success-message" id="successMessage"></div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let activities = [];
        let currentActivity = null;
        let editingActivityId = null;
        let filters = { 
            timeCommitment: '', 
            socialness: '', 
            dogFriendly: '', 
            price: '' 
        };

        // Utility functions
        function isLocalStorageAvailable() {
            try {
                const test = 'test';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch(e) {
                return false;
            }
        }

        function showMessage(message, type = 'error') {
            const errorEl = document.getElementById('errorMessage');
            const successEl = document.getElementById('successMessage');
            
            if (type === 'error') {
                errorEl.textContent = message;
                errorEl.style.display = 'block';
                successEl.style.display = 'none';
                
                // Auto-scroll to error message
                setTimeout(() => {
                    errorEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
            } else {
                successEl.textContent = message;
                successEl.style.display = 'block';
                errorEl.style.display = 'none';
                
                // Auto-scroll to success message
                setTimeout(() => {
                    successEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
            }
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                errorEl.style.display = 'none';
                successEl.style.display = 'none';
            }, 3000);
        }

        function hideMessages() {
            const errorEl = document.getElementById('errorMessage');
            const successEl = document.getElementById('successMessage');
            if (errorEl) errorEl.style.display = 'none';
            if (successEl) successEl.style.display = 'none';
        }

        // Data management functions
        function loadActivities() {
            if (isLocalStorageAvailable()) {
                const stored = localStorage.getItem('tactivities-data');
                if (stored) {
                    activities = JSON.parse(stored);
                    return;
                }
            }
            activities = getDefaultActivities();
            saveActivities();
        }

        function saveActivities() {
            if (isLocalStorageAvailable()) {
                try {
                    localStorage.setItem('tactivities-data', JSON.stringify(activities));
                } catch(e) {
                    console.log('localStorage not available');
                }
            }
        }

        // Formatting functions
        function formatTimeCommitment(time) {
            const timeMap = { 
                'quick': 'Quick (< 1 Hour)', 
                'short': 'Short (1-2 Hours)', 
                'medium': 'Medium (2-4 Hours)', 
                'long': 'Long (4+ Hours)' 
            };
            return timeMap[time] || time;
        }

        function formatSocialness(social) {
            if (Array.isArray(social)) {
                return social.map(s => formatSingleSocialness(s)).join(', ');
            }
            return formatSingleSocialness(social);
        }

        function formatSingleSocialness(social) {
            const socialMap = { 
                'solo': 'Solo', 
                'small_group': 'Small Group', 
                'large_gathering': 'Large Gathering', 
                'not_applicable': 'N/A' 
            };
            return socialMap[social] || social;
        }

        function formatDogFriendly(dogFriendly) {
            const dogMap = { 
                'yes': 'Dog Friendly', 
                'no': 'No Dogs', 
                'unknown': 'Unknown' 
            };
            return dogMap[dogFriendly] || 'Unknown';
        }

        function formatPrice(price) {
            const priceMap = { 
                'free': 'Free', 
                'low': '< $20', 
                'medium': '$21-$50', 
                'high': '$50+', 
                'unknown': 'Unknown' 
            };
            return priceMap[price] || 'Unknown';
        }

        function formatSeason(season) {
            return season ? season.charAt(0).toUpperCase() + season.slice(1) : '';
        }

        // Season and filtering functions
        function getCurrentSeason() {
            const month = new Date().getMonth() + 1;
            if (month >= 3 && month <= 5) return 'spring';
            if (month >= 6 && month <= 8) return 'summer';
            if (month >= 9 && month <= 11) return 'fall';
            return 'winter';
        }

        function getFilteredActivities() {
            const currentSeason = getCurrentSeason();
            return activities.filter(activity => {
                // Season filter
                if (activity.season && activity.season !== currentSeason) return false;
                
                // Time commitment filter
                if (filters.timeCommitment && activity.timeCommitment !== filters.timeCommitment) return false;
                
                // Social level filter - handle both arrays and strings
                if (filters.socialness) {
                    const activitySocialness = Array.isArray(activity.socialness) ? activity.socialness : [activity.socialness];
                    if (!activitySocialness.includes(filters.socialness)) return false;
                }
                
                // Dog friendly filter
                if (filters.dogFriendly && activity.dogFriendly !== filters.dogFriendly) return false;
                
                // Price filter
                if (filters.price && activity.price !== filters.price) return false;
                
                return true;
            });
        }

        // Activity display functions
        function showRandomActivity() {
            const filteredActivities = getFilteredActivities();
            if (filteredActivities.length === 0) {
                showNoActivities();
                return;
            }
            const randomIndex = Math.floor(Math.random() * filteredActivities.length);
            currentActivity = filteredActivities[randomIndex];
            renderActivity();
        }

        function showNoActivities() {
            document.getElementById('activityContainer').innerHTML = `
                <div class="no-activities">
                    <h3>No Activities Match Your Current Filters</h3>
                    <p>Try Adjusting Your Filters Or Add Some New Activities!</p>
                </div>
            `;
        }

        function renderActivity() {
            if (!currentActivity) return;
            const activity = currentActivity;
            
            // Format arrays for display
            const categoryDisplay = Array.isArray(activity.category) ? activity.category.join(', ') : activity.category;
            const socialnessDisplay = formatSocialness(activity.socialness);
            
            document.getElementById('activityContainer').innerHTML = `
                <div class="activity-card">
                    ${activity.completedCount > 0 ? `<div class="completed-badge">‚úì ${activity.completedCount}</div>` : ''}
                    <div class="activity-header">
                        <h2 class="activity-name">${activity.name}</h2>
                        <span class="activity-category">${categoryDisplay}</span>
                    </div>
                    <p class="activity-description">${activity.description}</p>
                    <div class="activity-meta">
                        <span class="meta-tag">‚è±Ô∏è ${formatTimeCommitment(activity.timeCommitment)}</span>
                        <span class="meta-tag">üë• ${socialnessDisplay}</span>
                        <span class="meta-tag">üêï ${formatDogFriendly(activity.dogFriendly)}</span>
                        <span class="meta-tag">üí∞ ${formatPrice(activity.price)}</span>
                        ${activity.season ? `<span class="meta-tag">üåø ${formatSeason(activity.season)}</span>` : ''}
                    </div>
                    ${activity.location ? `<div class="activity-location">üìç ${activity.location}</div>` : ''}
                    ${activity.notes ? `<div style="font-size: 0.9rem; color: #b8c5be; margin-top: 10px; font-style: italic;">${activity.notes}</div>` : ''}
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="completeActivity()">Sounds Good!</button>
                        <button class="btn btn-secondary" onclick="showRandomActivity()">Not This Time</button>
                    </div>
                </div>
            `;
        }

        function completeActivity() {
            if (!currentActivity) return;
            const activityIndex = activities.findIndex(a => a.id === currentActivity.id);
            if (activityIndex !== -1) {
                activities[activityIndex].completedCount++;
                saveActivities();
                currentActivity = activities[activityIndex];
                renderActivity();
            }
        }

        // Filter functions
        function toggleFilters() {
            document.getElementById('filtersContainer').classList.toggle('show');
        }

        function handleFilterChange() {
            filters.timeCommitment = document.getElementById('timeFilter').value;
            filters.socialness = document.getElementById('socialnessFilter').value;
            filters.dogFriendly = document.getElementById('dogFriendlyFilter').value;
            filters.price = document.getElementById('priceFilter').value;
            showRandomActivity();
        }

        // Modal functions
        function openManagementModal() {
            renderActivityList();
            document.getElementById('managementModal').style.display = 'block';
        }

        function closeManagementModal() {
            document.getElementById('managementModal').style.display = 'none';
        }

        function openAddActivityModal() {
            editingActivityId = null;
            document.getElementById('activityModalTitle').textContent = 'Add New Activity';
            document.getElementById('activityForm').reset();
            
            // Clear all checkboxes
            document.querySelectorAll('input[name="category"]').forEach(cb => cb.checked = false);
            document.querySelectorAll('input[name="socialness"]').forEach(cb => cb.checked = false);
            
            hideMessages();
            document.getElementById('activityModal').style.display = 'block';
        }

        function closeActivityModal() {
            document.getElementById('activityModal').style.display = 'none';
        }

        function openEditActivityModal(activityId) {
            const activity = activities.find(a => a.id === activityId);
            if (!activity) {
                console.error('Activity not found:', activityId);
                return;
            }
            
            editingActivityId = activityId;
            document.getElementById('activityModalTitle').textContent = 'Edit Activity';
            
            // Fill in text fields
            document.getElementById('activityName').value = activity.name || '';
            document.getElementById('activityDescription').value = activity.description || '';
            document.getElementById('activityTime').value = activity.timeCommitment || '';
            document.getElementById('activityDogFriendly').value = activity.dogFriendly || '';
            document.getElementById('activityPrice').value = activity.price || '';
            document.getElementById('activityLocation').value = activity.location || '';
            document.getElementById('activitySeason').value = activity.season || '';
            document.getElementById('activityNotes').value = activity.notes || '';
            
            // Clear all checkboxes first
            document.querySelectorAll('input[name="category"]').forEach(cb => cb.checked = false);
            document.querySelectorAll('input[name="socialness"]').forEach(cb => cb.checked = false);
            
            // Handle category checkboxes - support both old single values and new arrays
            if (activity.category) {
                const categories = Array.isArray(activity.category) ? activity.category : [activity.category];
                categories.forEach(cat => {
                    const checkbox = document.querySelector(`input[name="category"][value="${cat}"]`);
                    if (checkbox) {
                        checkbox.checked = true;
                    }
                });
            }
            
            // Handle socialness checkboxes - support both old single values and new arrays
            if (activity.socialness) {
                const socialLevels = Array.isArray(activity.socialness) ? activity.socialness : [activity.socialness];
                socialLevels.forEach(social => {
                    const checkbox = document.querySelector(`input[name="socialness"][value="${social}"]`);
                    if (checkbox) {
                        checkbox.checked = true;
                    }
                });
            }
            
            hideMessages();
            document.getElementById('activityModal').style.display = 'block';
        }

        // Activity CRUD functions
        function saveActivity() {
            try {
                // Get form elements
                const nameEl = document.getElementById('activityName');
                const descEl = document.getElementById('activityDescription');
                const timeEl = document.getElementById('activityTime');
                const dogEl = document.getElementById('activityDogFriendly');
                const priceEl = document.getElementById('activityPrice');
                const locEl = document.getElementById('activityLocation');
                const seasonEl = document.getElementById('activitySeason');
                const notesEl = document.getElementById('activityNotes');

                if (!nameEl || !descEl || !timeEl) {
                    throw new Error('Required form elements not found');
                }

                // Get checkbox values for categories and social levels
                const categoryCheckboxes = document.querySelectorAll('input[name="category"]:checked');
                const socialnessCheckboxes = document.querySelectorAll('input[name="socialness"]:checked');
                
                const categories = Array.from(categoryCheckboxes).map(cb => cb.value);
                const socialLevels = Array.from(socialnessCheckboxes).map(cb => cb.value);

                const formData = {
                    name: nameEl.value.trim(),
                    description: descEl.value.trim(),
                    category: categories,
                    timeCommitment: timeEl.value,
                    socialness: socialLevels,
                    dogFriendly: dogEl ? dogEl.value || 'unknown' : 'unknown',
                    price: priceEl ? priceEl.value || 'unknown' : 'unknown',
                    location: locEl ? locEl.value.trim() : '',
                    season: seasonEl ? seasonEl.value || null : null,
                    notes: notesEl ? notesEl.value.trim() : '',
                    dateAdded: new Date().toISOString()
                };

                // Validation
                const missingFields = [];
                if (!formData.name) missingFields.push('Activity Name');
                if (!formData.description) missingFields.push('Description');
                if (!formData.category || formData.category.length === 0) missingFields.push('Category');
                if (!formData.timeCommitment) missingFields.push('Time Commitment');
                if (!formData.socialness || formData.socialness.length === 0) missingFields.push('Social Level');

                if (missingFields.length > 0) {
                    showMessage('Please fill in these required fields: ' + missingFields.join(', '), 'error');
                    return;
                }

                if (editingActivityId) {
                    // Update existing activity
                    const index = activities.findIndex(a => a.id === editingActivityId);
                    if (index !== -1) {
                        activities[index] = { ...activities[index], ...formData };
                    }
                } else {
                    // Add new activity
                    const newActivity = {
                        id: Date.now().toString(),
                        completedCount: 0,
                        ...formData
                    };
                    activities.push(newActivity);
                }

                saveActivities();
                closeActivityModal();
                renderActivityList();
                showRandomActivity();
                
                showMessage('Activity saved successfully!', 'success');
                
            } catch (error) {
                console.error('Error saving activity:', error);
                showMessage('Error saving activity: ' + error.message, 'error');
            }
        }

        function deleteActivity(activityId) {
            const activity = activities.find(a => a.id === activityId);
            if (!activity) return;
            
            // Show confirmation UI
            const activityItem = document.querySelector(`[data-activity-id="${activityId}"]`);
            if (!activityItem) return;
            
            const existingConfirm = activityItem.querySelector('.delete-confirm');
            if (existingConfirm) {
                existingConfirm.remove();
                return;
            }
            
            const confirmDiv = document.createElement('div');
            confirmDiv.className = 'delete-confirm';
            confirmDiv.innerHTML = `
                <div class="delete-confirm-text">Delete "${activity.name}"?</div>
                <div class="delete-confirm-buttons">
                    <button class="btn-confirm-delete" onclick="confirmDeleteActivity('${activityId}')">Delete</button>
                    <button class="btn-cancel-delete" onclick="cancelDeleteActivity('${activityId}')">Cancel</button>
                </div>
            `;
            
            activityItem.appendChild(confirmDiv);
            confirmDiv.style.display = 'block';
        }

        function confirmDeleteActivity(activityId) {
            activities = activities.filter(a => a.id !== activityId);
            saveActivities();
            renderActivityList();
            showRandomActivity();
        }

        function cancelDeleteActivity(activityId) {
            const activityItem = document.querySelector(`[data-activity-id="${activityId}"]`);
            if (activityItem) {
                const confirmDiv = activityItem.querySelector('.delete-confirm');
                if (confirmDiv) {
                    confirmDiv.remove();
                }
            }
        }

        // Reset functionality
        function resetToDefaults() {
            const resetBtn = document.getElementById('resetDefaultsBtn');
            const existingConfirm = resetBtn.parentNode.querySelector('.reset-confirm');
            if (existingConfirm) {
                existingConfirm.remove();
                return;
            }
            
            const confirmDiv = document.createElement('div');
            confirmDiv.className = 'delete-confirm reset-confirm';
            confirmDiv.innerHTML = `
                <div class="delete-confirm-text">Reset to defaults? This will restore any missing default activities and reset all completion counts to 0. Custom activities will be preserved.</div>
                <div class="delete-confirm-buttons">
                    <button class="btn-confirm-delete" onclick="confirmResetDefaults()">Reset</button>
                    <button class="btn-cancel-delete" onclick="cancelResetDefaults()">Cancel</button>
                </div>
            `;
            
            resetBtn.parentNode.insertBefore(confirmDiv, resetBtn.nextSibling);
            confirmDiv.style.display = 'block';
        }

        function confirmResetDefaults() {
            try {
                const defaults = getDefaultActivities();
                
                // Reset completion counts for all existing activities
                activities.forEach(activity => {
                    activity.completedCount = 0;
                });
                
                // Find missing defaults and add them back
                let addedCount = 0;
                
                defaults.forEach(defaultActivity => {
                    const existingIndex = activities.findIndex(a => a.id === defaultActivity.id);
                    
                    if (existingIndex === -1) {
                        // Default activity is missing, add it back
                        activities.push({ ...defaultActivity });
                        addedCount++;
                    } else {
                        // Default activity exists, update it to current default structure
                        activities[existingIndex] = { ...defaultActivity, completedCount: 0 };
                    }
                });
                
                saveActivities();
                renderActivityList();
                showRandomActivity();
                
                // Update button text to show results
                const resetBtn = document.getElementById('resetDefaultsBtn');
                const originalText = resetBtn.textContent;
                
                resetBtn.textContent = `‚úì Reset Done! +${addedCount} restored`;
                resetBtn.style.background = '#7ba885';
                
                setTimeout(() => {
                    resetBtn.textContent = originalText;
                    resetBtn.style.background = '';
                }, 3000);
                
                cancelResetDefaults();
                
            } catch (error) {
                const resetBtn = document.getElementById('resetDefaultsBtn');
                const originalText = resetBtn.textContent;
                resetBtn.textContent = `‚úó Error: ${error.message}`;
                resetBtn.style.background = '#d67070';
                
                setTimeout(() => {
                    resetBtn.textContent = originalText;
                    resetBtn.style.background = '';
                }, 3000);
                
                cancelResetDefaults();
            }
        }

        function cancelResetDefaults() {
            const confirmDiv = document.querySelector('.reset-confirm');
            if (confirmDiv) {
                confirmDiv.remove();
            }
        }

        // Render activity list
        function renderActivityList() {
            if (activities.length === 0) {
                document.getElementById('activityList').innerHTML = '<p style="text-align: center; color: #8fa395;">No Activities Yet. Add Some To Get Started!</p>';
                return;
            }

            document.getElementById('activityList').innerHTML = activities.map(activity => {
                const categoryDisplay = Array.isArray(activity.category) ? activity.category.join(', ') : activity.category;
                const socialnessDisplay = formatSocialness(activity.socialness);
                
                return `
                    <div class="activity-item" data-activity-id="${activity.id}">
                        <div class="activity-item-name">${activity.name}</div>
                        <div class="activity-item-meta">
                            ${categoryDisplay} ‚Ä¢ ${formatTimeCommitment(activity.timeCommitment)} ‚Ä¢ ${socialnessDisplay} ‚Ä¢ ${formatDogFriendly(activity.dogFriendly)} ‚Ä¢ ${formatPrice(activity.price)}
                            ${activity.completedCount > 0 ? ` ‚Ä¢ Completed ${activity.completedCount} Times` : ''}
                        </div>
                        <div class="activity-item-actions">
                            <button class="btn btn-small btn-edit" onclick="openEditActivityModal('${activity.id}')">Edit</button>
                            <button class="btn btn-small btn-danger" onclick="deleteActivity('${activity.id}')">Delete</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Default activities data
        function getDefaultActivities() {
            return [
                {
                    id: '1',
                    name: 'Point Defiance Zoo & Aquarium',
                    description: 'See amazing animals from around the world, from playful otters to majestic tigers. Perfect for animal lovers of all ages!',
                    category: ['Outdoors'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Point Defiance, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Monday - Friday: 9 am - 4 pm, Saturday - Sunday: 9 am - 5 pm',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '2',
                    name: 'Chihuly Garden and Glass',
                    description: 'Experience stunning blown-glass art by world-renowned artist Dale Chihuly. Eight galleries, beautiful gardens, and a magnificent glasshouse with breathtaking installations.',
                    category: ['Culture'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Seattle Center, Seattle WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Generally open 10-11 am to 5-6 pm daily. Includes free audio tour and digital photos. Live glassblowing demos November-May.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '3',
                    name: 'Hike at Snake Lake Park',
                    description: 'Walk the peaceful 1-mile loop trail around serpentine Snake Lake. Great for birdwatching and spotting wildlife like wood ducks, turtles, and deer in this urban nature preserve.',
                    category: ['Outdoors', 'Fitness'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'quick',
                    dogFriendly: 'no',
                    price: 'free',
                    location: 'Tacoma Nature Center, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Trails open daily 8 am - dusk. Visitor center: Mon-Sat 9 am - 4 pm, closed Sundays. Dogs and bikes not allowed on trails.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '4',
                    name: 'Day Trip to Mt Rainier National Park',
                    description: 'Explore glacier-clad Mount Rainier with stunning alpine meadows, waterfalls, and hiking trails. Visit Paradise for incredible mountain views and wildflowers (summer) or snow activities (winter).',
                    category: ['Outdoors', 'Fitness'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'long',
                    dogFriendly: 'yes',
                    price: 'medium',
                    location: 'Mount Rainier National Park, WA',
                    completedCount: 0,
                    season: null,
                    notes: '2-2.5 hour drive from Tacoma. $30 vehicle entry fee (7 days). Paradise area typically accessible May-October. Dress in layers and bring waterproof shoes.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '5',
                    name: 'Sunset at Titlow Beach Park',
                    description: 'Watch stunning sunsets over the Olympic Mountains and Narrows Bridge from this sandy beach. Perfect for photography, picnics, and romantic evening walks.',
                    category: ['Outdoors', 'Social'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'quick',
                    dogFriendly: 'yes',
                    price: 'free',
                    location: 'Titlow Park, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Park open 30 min before dawn to 30 min after dusk. Limited parking - arrive early for prime sunset spots. Historic lodge and trails available.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '6',
                    name: 'Kayaking in Commencement Bay',
                    description: 'Paddle through calm waters with stunning views of downtown Tacoma, Mount Rainier, and the Olympic Mountains. Great for beginners and experienced kayakers alike.',
                    category: ['Outdoors', 'Fitness'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Owen Beach/Foss Waterway, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Rentals at Owen Beach summer season 10am-6pm. Singles $25-45, tandems $35-65. Launch spots: Owen Beach, Thea Foss Waterway, Titlow Park.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '7',
                    name: 'Ferry Ride to Vashon Island',
                    description: 'Take a scenic 15-minute ferry ride from Point Defiance to Vashon Island. Enjoy water views, explore the charming island, or just enjoy the peaceful ferry journey itself.',
                    category: ['Outdoors', 'Social'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'yes',
                    price: 'low',
                    location: 'Point Defiance Ferry Terminal, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Runs year-round, roughly hourly service. Walk-on passengers ~$6, cars ~$20. Ferry ride is 15 minutes each way. Free to return from island.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '8',
                    name: 'Museum of Glass',
                    description: 'Watch live glassblowing demonstrations in the iconic cone-shaped building. Experience contemporary glass art exhibitions and see artists create stunning pieces in the Hot Shop.',
                    category: ['Culture'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Downtown Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Open Wed-Sun 10am-5pm, closed Mon-Tue. Adults $22, Youth $13. Free admission 3rd Thursday 5-8pm. Live glassblowing during museum hours.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '9',
                    name: 'Tacoma Art Museum',
                    description: 'Explore Pacific Northwest art, including works by Dale Chihuly and regional artists. Features contemporary and historic art with rotating exhibitions.',
                    category: ['Culture'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'low',
                    location: 'Downtown Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Open Wed-Sun 10am-5pm, Thu until 8pm. Adults $18, Youth $10. Free admission Thursday 5-8pm. Focus on Northwest and Native American art.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '10',
                    name: 'Washington State History Museum',
                    description: 'Discover Washington state history through interactive exhibits, artifacts, and storytelling. Features permanent exhibits on Native American culture, pioneers, and industry.',
                    category: ['Culture'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'low',
                    location: 'Downtown Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Open Tue-Sun 10am-5pm, closed Mondays. Admission varies, check website. Free admission 3rd Thursday 3-8pm. Model railroad and interactive exhibits.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '11',
                    name: 'Freighthouse Square Market',
                    description: 'Browse unique shops and enjoy diverse international food court options in this historic converted train depot. Great for casual dining and discovering local artisans.',
                    category: ['Shopping', 'Food & Drink'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: '',
                    price: 'low',
                    location: 'Downtown Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Historic railroad building with international food court, antique shops, and local vendors. Located near Tacoma Dome Station.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '12',
                    name: 'Bluebeard Coffee Roasters',
                    description: 'Visit a local coffee roastery with excellent small-batch specialty coffee in a bright, airy space. Perfect for working, reading, or catching up with friends.',
                    category: ['Food & Drink', 'Social'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'quick',
                    dogFriendly: '',
                    price: 'low',
                    location: '6th Avenue, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Open daily 7am-5pm. Two locations: 2201 6th Ave and 5428 S Tacoma Way. Local roaster with spacious seating and large windows.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '13',
                    name: 'King\'s Books',
                    description: 'Explore Tacoma\'s largest independent bookstore with 150,000 new and used books, plus friendly resident cats. A beloved community gathering place for book lovers.',
                    category: ['Shopping', 'Social'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: '',
                    price: 'low',
                    location: 'Stadium District, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Open daily 11am-7pm. 218 St Helens Ave. Features bookstore cats, events, and book clubs. $25 annual membership for 10% discount.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '14',
                    name: 'McMenamins Elks Temple',
                    description: 'Historic renovated Elks lodge featuring multiple bars, dining areas, and unique themed rooms. Enjoy McMenamins signature ales and pub food in this architectural gem with rich local history.',
                    category: ['Food & Drink', 'Culture', 'Social'],
                    socialness: ['small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Downtown Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Historic 1916 building with multiple themed rooms including the Crystal Ballroom. Full restaurant and bar service. Check for live music and events.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '15',
                    name: '7 Seas Brewing',
                    description: 'Local craft brewery known for innovative beers and a welcoming taproom atmosphere. Features rotating seasonal brews, food trucks, and community events in a industrial-chic setting.',
                    category: ['Food & Drink', 'Social'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'yes',
                    price: 'medium',
                    location: 'Gig Harbor/Tacoma area, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Dog-friendly patio. Regular food trucks and events. Known for creative beer styles and community involvement. Check hours and current taps online.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '16',
                    name: 'Narrows Brewing',
                    description: 'Waterfront craft brewery with stunning views of the Tacoma Narrows and bridge. Enjoy handcrafted beers, wood-fired pizzas, and outdoor seating overlooking the water.',
                    category: ['Food & Drink', 'Social', 'Outdoors'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'yes',
                    price: 'medium',
                    location: 'Tacoma Narrows, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Waterfront location with outdoor seating and bridge views. Wood-fired pizzas and craft beer. Dog-friendly patio. Great for sunset viewing.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '17',
                    name: 'Ice Skating at Sprinker Recreation Center',
                    description: 'Year-round indoor ice skating at this full-service recreation facility. Perfect for families, date nights, or solo skating sessions with skate rentals available.',
                    category: ['Entertainment', 'Fitness', 'Social'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'low',
                    location: 'Sprinker Recreation Center, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Public skating sessions vary by day. Skate rentals available. Also offers hockey leagues and figure skating. Check schedule online for public session times.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '18',
                    name: 'Wright Park Concerts',
                    description: 'Free outdoor concerts in beautiful Wright Park featuring local and touring musicians. Bring a blanket or chair and enjoy live music in a scenic park setting with the historic conservatory nearby.',
                    category: ['Entertainment', 'Social', 'Outdoors'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'yes',
                    price: 'free',
                    location: 'Wright Park, Tacoma WA',
                    completedCount: 0,
                    season: 'summer',
                    notes: 'Summer concert series typically June-August. Free admission. Bring blankets or chairs. Food vendors often available. Check Metro Parks schedule for dates and performers.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '19',
                    name: 'Brown & Haley Candy Factory Tour',
                    description: 'Take a sweet journey through the home of Almond Roca! See how the famous chocolate confections are made, learn about the company\'s Tacoma history, and enjoy samples of delicious treats.',
                    category: ['Culture', 'Food & Drink'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'low',
                    location: 'Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Tours typically offered on weekdays. Free admission with advance reservations required. Includes factory viewing, history, and chocolate samples. Call ahead to confirm availability.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '20',
                    name: 'Point Defiance Park Trails',
                    description: 'Explore miles of forested trails in this 760-acre urban park. Hike through old-growth forest, discover hidden beaches, and enjoy the scenic 5-Mile Drive with stunning Puget Sound views.',
                    category: ['Outdoors', 'Fitness'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'medium',
                    dogFriendly: 'yes',
                    price: 'free',
                    location: 'Point Defiance Park, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Park open dawn to dusk. Multiple trail options from easy walks to moderate hikes. 5-Mile Drive is one-way loop. Free parking. Trail maps available at entrance.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '21',
                    name: 'Owen Beach',
                    description: 'Relax at this sandy beach in Point Defiance Park with spectacular views of Vashon Island and the Olympic Mountains. Perfect for swimming, picnicking, and watching ferries pass by.',
                    category: ['Outdoors', 'Social'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'yes',
                    price: 'free',
                    location: 'Point Defiance Park, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Sandy beach with picnic tables, restrooms, and kayak rentals (seasonal). Great for sunset viewing. Can get busy on weekends. Part of Point Defiance Park.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '22',
                    name: 'Dune Peninsula at Chambers Bay',
                    description: 'Hike the dramatic coastal bluffs and dunes with panoramic views of Puget Sound, Olympic Mountains, and Vashon Island. Features unique prairie habitat and excellent photography opportunities.',
                    category: ['Outdoors', 'Fitness'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'yes',
                    price: 'free',
                    location: 'Chambers Bay, University Place WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Trail network with varying difficulty. Stunning views year-round. Can be windy. Adjacent to Chambers Bay Golf Course. Free parking available.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '23',
                    name: 'The Swiss Restaurant & Pub',
                    description: 'Historic alpine-themed restaurant and bar featuring German and Swiss cuisine, local beers, and live music in a cozy mountain lodge atmosphere. A Tacoma institution since 1913.',
                    category: ['Food & Drink', 'Entertainment', 'Social'],
                    socialness: ['small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Historic venue with alpine decor and traditional European dishes. Live music on weekends. Full bar with German beers. Reservations recommended for dinner.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '24',
                    name: 'Temple Theatre',
                    description: 'Intimate historic theater featuring local productions, concerts, and community events. Experience live performances in this beautifully restored 1920s venue with excellent acoustics.',
                    category: ['Entertainment', 'Culture'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Downtown Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Historic 1920s theater with 298 seats. Features local theater companies, concerts, and special events. Check calendar for showtimes. Tickets typically $15-35.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '25',
                    name: 'Glass Blowing Classes',
                    description: 'Learn the ancient art of glassblowing at local studios. Create your own glass ornaments, bowls, or sculptures while learning techniques from experienced artisans in Tacoma\'s vibrant glass community.',
                    category: ['Creative', 'Culture'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'medium',
                    dogFriendly: 'no',
                    price: 'high',
                    location: 'Various studios, Tacoma WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Multiple studios offer classes: Tacoma Glassblowing Studio, Glass House Studio, others. Typically $75-150 per session. All skill levels welcome. Advance registration required.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '26',
                    name: 'Rock Climbing at Vertical World',
                    description: 'Challenge yourself on indoor climbing walls with routes for all skill levels. Great for beginners and experienced climbers, with equipment rentals and instruction available.',
                    category: ['Fitness', 'Social'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Seattle/Tacoma area, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Indoor climbing gym with bouldering and rope climbing. Day passes ~$20, gear rental available. Beginner classes offered. Multiple locations in greater Seattle area.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '27',
                    name: 'Tacoma Holiday Food & Gift Festival',
                    description: 'Browse unique holiday gifts from local artisans and vendors while enjoying seasonal treats and entertainment. Perfect for holiday shopping and getting into the festive spirit.',
                    category: ['Shopping', 'Food & Drink', 'Social'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'medium',
                    dogFriendly: '',
                    price: 'medium',
                    location: 'Tacoma Dome, Tacoma WA',
                    completedCount: 0,
                    season: 'winter',
                    notes: 'Annual December event featuring local vendors, holiday foods, crafts, and entertainment. Admission fee required. Great for holiday shopping and family outings.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '28',
                    name: 'Ethnic Fest',
                    description: 'Celebrate Tacoma\'s diverse cultural heritage with food, music, dance, and art from communities around the world. Experience authentic cuisine and performances in a vibrant festival atmosphere.',
                    category: ['Culture', 'Food & Drink', 'Entertainment'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'medium',
                    dogFriendly: '',
                    price: 'low',
                    location: 'Various venues, Tacoma WA',
                    completedCount: 0,
                    season: 'summer',
                    notes: 'Annual summer cultural celebration featuring food vendors, live performances, and cultural exhibits. Usually held in parks or community centers. Family-friendly event.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '29',
                    name: 'Tacoma Film Festival',
                    description: 'Discover independent films, documentaries, and shorts from local and international filmmakers. Enjoy screenings, filmmaker Q&As, and special events celebrating cinema arts.',
                    category: ['Culture', 'Entertainment'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Various theaters, Tacoma WA',
                    completedCount: 0,
                    season: 'fall',
                    notes: 'Annual fall film festival featuring indie films, documentaries, and shorts. Multiple venue screenings throughout Tacoma. Individual tickets and festival passes available.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '30',
                    name: 'Daffodil Festival Parade',
                    description: 'Celebrate spring with this beloved Pacific Northwest tradition featuring colorful floats, marching bands, and community groups. One of the largest floral parades in the region.',
                    category: ['Entertainment', 'Social', 'Culture'],
                    socialness: ['solo', 'small_group', 'large_gathering'],
                    timeCommitment: 'medium',
                    dogFriendly: 'yes',
                    price: 'free',
                    location: 'Downtown Tacoma & surrounding cities, WA',
                    completedCount: 0,
                    season: 'spring',
                    notes: 'Annual April parade celebrating spring and daffodil blooms. Multiple parade routes through Tacoma, Puyallup, and other cities. Free street-side viewing. Bring chairs.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '31',
                    name: 'Tacoma Ghost Tours',
                    description: 'Explore Tacoma\'s haunted history on guided walking tours through downtown\'s most supernatural locations. Visit reportedly haunted theaters, hotels, and historic buildings while learning spine-chilling local legends.',
                    category: ['Entertainment', 'Culture'],
                    socialness: ['small_group', 'large_gathering'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Downtown Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Evening tours typically offered weekends, with special Halloween season events. Tours last 1-2 hours. Advance booking recommended. Not recommended for young children.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '32',
                    name: 'Tacoma Tunnel Tours',
                    description: 'Discover the hidden underground passages beneath downtown Tacoma on guided tours of the historic tunnel system. Learn about Prohibition-era secrets and the city\'s underground history.',
                    category: ['Culture'],
                    socialness: ['small_group'],
                    timeCommitment: 'short',
                    dogFriendly: 'no',
                    price: 'medium',
                    location: 'Downtown Tacoma, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Limited tours offered by historical society or special events. Advance reservations required. Wear comfortable walking shoes and bring a light jacket - tunnels are cool year-round.',
                    dateAdded: new Date().toISOString()
                },
                {
                    id: '33',
                    name: 'Spaceworks Tacoma Open Studios',
                    description: 'Explore working artist studios in converted warehouse spaces during monthly open studio events. Meet local artists, see works in progress, and discover everything from metalworking to fiber arts in an authentic creative community.',
                    category: ['Culture', 'Creative'],
                    socialness: ['solo', 'small_group'],
                    timeCommitment: 'short',
                    dogFriendly: '',
                    price: 'free',
                    location: 'Tacoma warehouse district, WA',
                    completedCount: 0,
                    season: null,
                    notes: 'Monthly events typically first Friday or Saturday. Free admission. Self-guided tours through multiple artist studios. Some artwork available for purchase. Check Spaceworks calendar for dates.',
                    dateAdded: new Date().toISOString()
                }
            ];
        }

        // Event handlers
        function setupEventListeners() {
            // Filter controls
            document.getElementById('filterBtn').addEventListener('click', toggleFilters);
            document.getElementById('timeFilter').addEventListener('change', handleFilterChange);
            document.getElementById('socialnessFilter').addEventListener('change', handleFilterChange);
            document.getElementById('dogFriendlyFilter').addEventListener('change', handleFilterChange);
            document.getElementById('priceFilter').addEventListener('change', handleFilterChange);
            
            // Modal controls
            document.getElementById('managementBtn').addEventListener('click', openManagementModal);
            document.getElementById('addActivityBtn').addEventListener('click', openAddActivityModal);
            document.getElementById('closeManagementModal').addEventListener('click', closeManagementModal);
            document.getElementById('closeActivityModal').addEventListener('click', closeActivityModal);
            
            // Form submission
            document.getElementById('saveActivityBtn').addEventListener('click', saveActivity);
            
            // Reset functionality
            document.getElementById('resetDefaultsBtn').addEventListener('click', resetToDefaults);
            
            // Modal backdrop click
            window.addEventListener('click', function(event) {
                if (event.target === document.getElementById('managementModal')) {
                    closeManagementModal();
                }
                if (event.target === document.getElementById('activityModal')) {
                    closeActivityModal();
                }
            });
        }

        // Initialization
        function init() {
            loadActivities();
            setupEventListeners();
            showRandomActivity();
        }

        // Start the app when DOM is ready
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
